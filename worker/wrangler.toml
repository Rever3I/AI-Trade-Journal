name = "ai-trade-journal-worker"
main = "src/index.js"
compatibility_date = "2024-12-01"
compatibility_flags = ["nodejs_compat"]

# ---- Environment Variables (non-secret, overridable per environment) ----
[vars]
ALLOWED_ORIGIN = "*"
CLAUDE_MODEL = "claude-sonnet-4-20250514"
DAILY_ANALYSIS_LIMIT = "10"
MONTHLY_ANALYSIS_LIMIT = "200"

# ---- D1 Database Binding ----
[[d1_databases]]
binding = "DB"
database_name = "trade_journal_db"
database_id = "REPLACE_WITH_ACTUAL_D1_DATABASE_ID"

# ---- KV Namespace Binding ----
[[kv_namespaces]]
binding = "RATE_LIMIT_KV"
id = "REPLACE_WITH_ACTUAL_KV_NAMESPACE_ID"

# ---- Development Environment ----
[env.dev]
name = "ai-trade-journal-worker-dev"

[env.dev.vars]
ALLOWED_ORIGIN = "*"
CLAUDE_MODEL = "claude-sonnet-4-20250514"
DAILY_ANALYSIS_LIMIT = "10"
MONTHLY_ANALYSIS_LIMIT = "200"

[[env.dev.d1_databases]]
binding = "DB"
database_name = "trade_journal_db"
database_id = "REPLACE_WITH_ACTUAL_D1_DATABASE_ID"

[[env.dev.kv_namespaces]]
binding = "RATE_LIMIT_KV"
id = "REPLACE_WITH_ACTUAL_KV_NAMESPACE_ID"

# ---- Production Environment ----
[env.production]
name = "ai-trade-journal-worker"
routes = [
  { pattern = "api.your-domain.com/*", zone_name = "your-domain.com" }
]

[env.production.vars]
ALLOWED_ORIGIN = "chrome-extension://REPLACE_WITH_EXTENSION_ID"
CLAUDE_MODEL = "claude-sonnet-4-20250514"
DAILY_ANALYSIS_LIMIT = "10"
MONTHLY_ANALYSIS_LIMIT = "200"

[[env.production.d1_databases]]
binding = "DB"
database_name = "trade_journal_db"
database_id = "REPLACE_WITH_ACTUAL_D1_DATABASE_ID"

[[env.production.kv_namespaces]]
binding = "RATE_LIMIT_KV"
id = "REPLACE_WITH_ACTUAL_KV_NAMESPACE_ID"

# ---- Secrets (set via `wrangler secret put`) ----
# ANTHROPIC_API_KEY
# NOTION_CLIENT_ID
# NOTION_CLIENT_SECRET
# NOTION_REDIRECT_URI
# LICENSE_SIGNING_SECRET
